<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CyberShield Academy - Cybersecurity Training</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .dashboard {
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 20px;
            margin-bottom: 30px;
        }

        .main-content {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .user-profile {
            background: white;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(45deg, #4CAF50, #45a049);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2rem;
            margin: 0 auto 15px;
        }

        .level-progress {
            background: #f0f0f0;
            border-radius: 10px;
            height: 20px;
            margin: 15px 0;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #45a049);
            border-radius: 10px;
            transition: width 0.3s ease;
            width: 65%;
        }

        .badges-section {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .badges-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 15px;
        }

        .badge {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            transition: transform 0.2s ease;
            cursor: pointer;
        }

        .badge:hover {
            transform: scale(1.1);
        }

        .badge.earned {
            background: linear-gradient(45deg, #FFD700, #FFA500);
            color: white;
            box-shadow: 0 4px 8px rgba(255, 215, 0, 0.3);
        }

        .badge.locked {
            background: #e0e0e0;
            color: #999;
        }

        .leaderboard {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .leaderboard-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px;
            margin: 5px 0;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .leaderboard-item.current-user {
            background: linear-gradient(90deg, #4CAF50, #45a049);
            color: white;
        }

        .rank {
            font-weight: bold;
            font-size: 1.2rem;
            width: 30px;
        }

        .course-modules {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .module-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: transform 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .module-card:hover {
            transform: translateY(-5px);
        }

        .module-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        .module-progress {
            background: rgba(255,255,255,0.2);
            border-radius: 10px;
            height: 8px;
            margin-top: 15px;
            overflow: hidden;
        }

        .module-progress-bar {
            height: 100%;
            background: rgba(255,255,255,0.8);
            border-radius: 10px;
            transition: width 0.3s ease;
        }

        .view {
            display: none;
        }

        .view.active {
            display: block;
        }

        .scenario-header {
            text-align: center;
            margin-bottom: 25px;
        }

        .scenario-content {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 4px solid #667eea;
        }

        .options {
            display: grid;
            gap: 10px;
            margin: 20px 0;
        }

        .option {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .option:hover {
            border-color: #667eea;
            background: #f0f4ff;
        }

        .option.selected {
            border-color: #2196f3;
            background: #e3f2fd;
        }

        .option.correct {
            border-color: #4CAF50;
            background: #e8f5e8;
        }

        .option.incorrect {
            border-color: #f44336;
            background: #ffebee;
        }

        .option.disabled {
            pointer-events: none;
            opacity: 0.7;
        }

        .btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 10px;
            padding: 12px 25px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .feedback {
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            display: none;
        }

        .feedback.success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            display: block;
        }

        .feedback.error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
            display: block;
        }

        .points-animation {
            position: fixed;
            font-size: 2rem;
            font-weight: bold;
            color: #4CAF50;
            z-index: 1000;
            pointer-events: none;
            animation: pointsFloat 2s ease-out forwards;
        }

        @keyframes pointsFloat {
            0% {
                opacity: 1;
                transform: translateY(0);
            }
            100% {
                opacity: 0;
                transform: translateY(-100px);
            }
        }

        .achievement-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            z-index: 1000;
            text-align: center;
            display: none;
        }

        .achievement-popup.show {
            display: block;
            animation: achievementPop 0.5s ease-out;
        }

        @keyframes achievementPop {
            0% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.8);
            }
            100% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 999;
            display: none;
        }

        .overlay.show {
            display: block;
        }

        .quiz-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .timer {
            font-size: 1.5rem;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 20px;
        }

        .quiz-progress {
            background: #e0e0e0;
            border-radius: 10px;
            height: 10px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .quiz-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #45a049);
            border-radius: 10px;
            transition: width 0.3s ease;
        }

        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .course-modules {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üõ°Ô∏è CyberShield Academy</h1>
            <p>Master cybersecurity through interactive learning and challenges</p>
        </div>

        <div class="dashboard">
            <div class="main-content">
                <!-- Home View -->
                <div id="home-view" class="view active">
                    <h2>Welcome to Your Cybersecurity Journey</h2>
                    <p>Build your skills through interactive modules, earn badges, and climb the leaderboard!</p>
                    
                    <div class="course-modules">
                        <div class="module-card" data-module="phishing">
                            <div class="module-icon">üé£</div>
                            <h3>Phishing Awareness</h3>
                            <p>Learn to identify and avoid phishing attacks</p>
                            <div class="module-progress">
                                <div class="module-progress-bar" style="width: 60%"></div>
                            </div>
                        </div>

                        <div class="module-card" data-module="passwords">
                            <div class="module-icon">üîí</div>
                            <h3>Password Security</h3>
                            <p>Create and manage strong passwords</p>
                            <div class="module-progress">
                                <div class="module-progress-bar" style="width: 80%"></div>
                            </div>
                        </div>

                        <div class="module-card" data-module="social">
                            <div class="module-icon">üë•</div>
                            <h3>Social Engineering</h3>
                            <p>Recognize manipulation tactics</p>
                            <div class="module-progress">
                                <div class="module-progress-bar" style="width: 40%"></div>
                            </div>
                        </div>

                        <div class="module-card" data-module="quiz">
                            <div class="module-icon">üìù</div>
                            <h3>Security Quiz</h3>
                            <p>Test your knowledge with timed questions</p>
                            <div class="module-progress">
                                <div class="module-progress-bar" style="width: 75%"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Scenario View -->
                <div id="scenario-view" class="view">
                    <div class="scenario-header">
                        <h2 id="scenario-title">Interactive Scenario</h2>
                        <p id="scenario-description">Test your knowledge in real-world situations</p>
                    </div>
                    
                    <div id="scenario-content" class="scenario-content">
                        <!-- Dynamic content will be loaded here -->
                    </div>
                    
                    <div id="scenario-options" class="options">
                        <!-- Options will be loaded here -->
                    </div>
                    
                    <div id="scenario-feedback" class="feedback">
                        <!-- Feedback will be shown here -->
                    </div>
                    
                    <div style="text-align: center; margin-top: 20px;">
                        <button id="submit-btn" class="btn">Submit Answer</button>
                        <button id="next-btn" class="btn" style="display: none;">Next Challenge</button>
                        <button id="back-btn" class="btn">Back to Modules</button>
                    </div>
                </div>

                <!-- Quiz View -->
                <div id="quiz-view" class="view">
                    <div class="quiz-header">
                        <div class="timer" id="timer">30</div>
                        <div>Question <span id="current-question">1</span> of <span id="total-questions">5</span></div>
                        <div class="quiz-progress">
                            <div class="quiz-progress-bar" id="quiz-progress-bar" style="width: 20%"></div>
                        </div>
                    </div>
                    
                    <div id="quiz-question">
                        <h3 id="question-text">What is the most secure way to create a password?</h3>
                        <div id="quiz-options" class="options">
                            <!-- Quiz options will be loaded here -->
                        </div>
                    </div>
                    
                    <div id="quiz-feedback" class="feedback">
                        <!-- Quiz feedback will be shown here -->
                    </div>
                    
                    <div style="text-align: center; margin-top: 20px;">
                        <button id="quiz-submit-btn" class="btn">Submit Answer</button>
                        <button id="quiz-next-btn" class="btn" style="display: none;">Next Question</button>
                        <button id="quiz-finish-btn" class="btn" style="display: none;">Finish Quiz</button>
                        <button id="quiz-back-btn" class="btn">Back to Modules</button>
                    </div>
                </div>
            </div>

            <div class="sidebar">
                <div class="user-profile">
                    <div class="avatar">CS</div>
                    <h3>Cyber Student</h3>
                    <p><strong>Level 3</strong> Security Apprentice</p>
                    <div class="level-progress">
                        <div class="progress-bar"></div>
                    </div>
                    <p id="user-points"><strong>2,450</strong> points</p>
                    <p id="next-level">Next level: 550 points to go</p>
                </div>

                <div class="badges-section">
                    <h3>Achievements</h3>
                    <div class="badges-grid">
                        <div class="badge earned" title="First Login">üèÜ</div>
                        <div class="badge earned" title="Phishing Expert">üé£</div>
                        <div class="badge earned" title="Password Master">üîí</div>
                        <div class="badge earned" title="Quiz Completed">üìù</div>
                        <div class="badge earned" title="Social Engineering Aware">üë•</div>
                        <div class="badge locked" title="Malware Hunter">ü¶†</div>
                        <div class="badge locked" title="WiFi Guardian">üì∂</div>
                        <div class="badge locked" title="Data Protector">üìä</div>
                        <div class="badge locked" title="Security Champion">ü•á</div>
                    </div>
                </div>

                <div class="leaderboard">
                    <h3>üèÜ Leaderboard</h3>
                    <div class="leaderboard-item">
                        <div><span class="rank">1</span><span>Alex Chen</span></div>
                        <span>3,850 pts</span>
                    </div>
                    <div class="leaderboard-item">
                        <div><span class="rank">2</span><span>Sarah Kim</span></div>
                        <span>3,120 pts</span>
                    </div>
                    <div class="leaderboard-item current-user">
                        <div><span class="rank">3</span><span>You</span></div>
                        <span id="leaderboard-points">2,450 pts</span>
                    </div>
                    <div class="leaderboard-item">
                        <div><span class="rank">4</span><span>Mike Johnson</span></div>
                        <span>2,180 pts</span>
                    </div>
                    <div class="leaderboard-item">
                        <div><span class="rank">5</span><span>Lisa Wang</span></div>
                        <span>1,950 pts</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Achievement Popup -->
    <div class="overlay" id="overlay"></div>
    <div class="achievement-popup" id="achievement-popup">
        <h2>üéâ Achievement Unlocked!</h2>
        <div style="font-size: 4rem; margin: 20px 0;">üèÜ</div>
        <h3 id="achievement-title">Security Champion</h3>
        <p id="achievement-description">You've mastered all cybersecurity modules!</p>
        <button class="btn" id="close-achievement">Awesome!</button>
    </div>

    <script>
        // Global variables
        let currentUser = {
            name: "Cyber Student",
            level: 3,
            points: 2450,
            progress: 65,
            badges: ['first-login', 'phishing-expert', 'password-master', 'quiz-completed', 'social-engineering']
        };

        let currentScenario = null;
        let selectedOption = null;
        let currentQuizQuestion = 1;
        let quizTimer = 30;
        let timerInterval = null;

        // Scenario data
        const scenarios = {
            phishing: [
                {
                    title: "Suspicious Email Alert",
                    content: "You receive an email claiming to be from your bank asking you to verify your account immediately by clicking a link. The email looks legitimate but something feels off.",
                    options: [
                        { text: "Click the link immediately to secure my account", correct: false },
                        { text: "Check the sender's email address and contact the bank directly", correct: true },
                        { text: "Forward the email to colleagues to warn them", correct: false },
                        { text: "Delete the email without taking any action", correct: false }
                    ],
                    feedback: {
                        correct: "Excellent! Always verify suspicious emails by contacting the organization directly through official channels.",
                        incorrect: "Not quite. The safest approach is to verify suspicious emails through official channels rather than clicking links."
                    }
                },
                {
                    title: "Urgent IT Support Call",
                    content: "You receive a phone call from someone claiming to be from IT support. They say there's a security breach and they need your password to fix it immediately.",
                    options: [
                        { text: "Provide my password since it's an emergency", correct: false },
                        { text: "Ask for their employee ID and verify with IT department", correct: true },
                        { text: "Hang up immediately", correct: false },
                        { text: "Give them a fake password", correct: false }
                    ],
                    feedback: {
                        correct: "Perfect! Legitimate IT support will never ask for your password over the phone.",
                        incorrect: "Remember: Real IT support will never ask for your password over the phone. Always verify the caller's identity."
                    }
                }
            ],
            passwords: [
                {
                    title: "Creating a Secure Password",
                    content: "You need to create a new password for your work account. The system requires a strong password but you want something memorable.",
                    options: [
                        { text: "Use your birthday and add some special characters", correct: false },
                        { text: "Create a passphrase using unrelated words with numbers", correct: true },
                        { text: "Use the same password you use for other accounts", correct: false },
                        { text: "Use a common word with numbers substituted for letters", correct: false }
                    ],
                    feedback: {
                        correct: "Great choice! Passphrases with unrelated words are both secure and memorable.",
                        incorrect: "A strong password should be unique and not based on personal information. Try using a passphrase instead."
                    }
                }
            ],
            social: [
                {
                    title: "Tailgating Attempt",
                    content: "A friendly person in business attire follows you closely to the building entrance and asks you to hold the door open, claiming they forgot their access card.",
                    options: [
                        { text: "Hold the door open since they look like they belong", correct: false },
                        { text: "Politely ask them to use their own access or contact security", correct: true },
                        { text: "Let them in but keep an eye on them", correct: false },
                        { text: "Ask to see their employee ID", correct: false }
                    ],
                    feedback: {
                        correct: "Excellent security awareness! Never allow unauthorized access, even if the person seems legitimate.",
                        incorrect: "This could be a social engineering attack called tailgating. Always ensure proper access procedures are followed."
                    }
                }
            ]
        };

        // Quiz data
        const quizQuestions = [
            {
                question: "What is the most secure way to create a password?",
                options: [
                    "Use your name and birthday",
                    "Use a long passphrase with random words",
                    "Use common dictionary words",
                    "Use the same password everywhere"
                ],
                correct: 1
            },
            {
                question: "How can you identify a phishing email?",
                options: [
                    "It has perfect grammar and spelling",
                    "It comes from a known contact",
                    "It creates urgency and asks for personal information",
                    "It has company logos"
                ],
                correct: 2
            },
            {
                question: "What should you do if you receive a suspicious attachment?",
                options: [
                    "Open it to see what it contains",
                    "Forward it to colleagues for their opinion",
                    "Don't open it and report it to IT",
                    "Save it for later review"
                ],
                correct: 2
            },
            {
                question: "What is two-factor authentication?",
                options: [
                    "Using two different passwords",
                    "An additional security layer beyond passwords",
                    "Having two user accounts",
                    "Using password and username"
                ],
                correct: 1
            },
            {
                question: "What makes a WiFi network secure?",
                options: [
                    "It has a strong signal",
                    "It's password-protected with WPA3 encryption",
                    "It has many users",
                    "It's provided by a business"
                ],
                correct: 1
            }
        ];

        // Initialize the course
        function init() {
            setupEventListeners();
            updateUserProfile();
        }

        // Setup all event listeners
        function setupEventListeners() {
            // Module card clicks
            document.querySelectorAll('.module-card').forEach(card => {
                card.addEventListener('click', function() {
                    const module = this.getAttribute('data-module');
                    if (module === 'quiz') {
                        startQuiz();
                    } else {
                        startModule(module);
                    }
                });
            });

            // Button clicks
            document.getElementById('submit-btn').addEventListener('click', submitAnswer);
            document.getElementById('next-btn').addEventListener('click', nextScenario);
            document.getElementById('back-btn').addEventListener('click', backToHome);
            
            document.getElementById('quiz-submit-btn').addEventListener('click', submitQuizAnswer);
            document.getElementById('quiz-next-btn').addEventListener('click', nextQuestion);
            document.getElementById('quiz-finish-btn').addEventListener('click', finishQuiz);
            document.getElementById('quiz-back-btn').addEventListener('click', backToHome);
            
            document.getElementById('close-achievement').addEventListener('click', closeAchievement);
            document.getElementById('overlay').addEventListener('click', closeAchievement);
        }

        // Show specific view
        function showView(viewId) {
            document.querySelectorAll('.view').forEach(view => {
                view.classList.remove('active');
            });
            document.getElementById(viewId).classList.add('active');
        }

        // Start a module
        function startModule(moduleType) {
            showView('scenario-view');
            loadScenario(moduleType, 0);
        }

        // Load scenario
        function loadScenario(moduleType, scenarioIndex) {
            currentScenario = {
                type: moduleType,
                index: scenarioIndex,
                scenarios: scenarios[moduleType] || scenarios.phishing
            };

            const scenario = currentScenario.scenarios[scenarioIndex] || currentScenario.scenarios[0];
            
            document.getElementById('scenario-title').textContent = scenario.title;
            document.getElementById('scenario-description').textContent = `${moduleType.charAt(0).toUpperCase() + moduleType.slice(1)} Challenge`;
            document.getElementById('scenario-content').textContent = scenario.content;
            
            const optionsContainer = document.getElementById('scenario-options');
            optionsContainer.innerHTML = '';
            
            scenario.options.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'option';
                optionDiv.textContent = option.text;
                optionDiv.addEventListener('click', () => selectOption(index));
                optionsContainer.appendChild(optionDiv);
            });
            
            selectedOption = null;
            resetScenarioUI();
        }

        // Reset scenario UI
        function resetScenarioUI() {
            document.getElementById('scenario-feedback').className = 'feedback';
            document.getElementById('submit-btn').style.display = 'inline-block';
            document.getElementById('next-btn').style.display = 'none';
        }

        // Select option
        function selectOption(index) {
            selectedOption = index;
            const options = document.querySelectorAll('#scenario-options .option');
            options.forEach((option, i) => {
                option.classList.remove('selected');
                if (i === index) {
                    option.classList.add('selected');
                }
            });
        }

        // Submit answer
        function submitAnswer() {
            if (selectedOption === null) {
                alert('Please select an answer first!');
                return;
            }

            const scenario = currentScenario.scenarios[currentScenario.index];
            const selectedOptionData = scenario.options[selectedOption];
            const isCorrect = selectedOptionData.correct;
            
            const options = document.querySelectorAll('#scenario-options .option');
            options.forEach((option, index) => {
                option.classList.add('disabled');
                if (scenario.options[index].correct) {
                    option.classList.add('correct');
                } else if (index === selectedOption && !isCorrect) {
                    option.classList.add('incorrect');
                }
            });

            const feedback = document.getElementById('scenario-feedback');
            feedback.textContent = isCorrect ? scenario.feedback.correct : scenario.feedback.incorrect;
            feedback.className = `feedback ${isCorrect ? 'success' : 'error'}`;

            if (isCorrect) {
                addPoints(100);
                checkForAchievements();
            } else {
                addPoints(25);
            }

            document.getElementById('submit-btn').style.display = 'none';
            document.getElementById('next-btn').style.display = 'inline-block';
        }

        // Next scenario
        function nextScenario() {
            const nextIndex = currentScenario.index + 1;
            if (nextIndex < currentScenario.scenarios.length) {
                loadScenario(currentScenario.type, nextIndex);
            } else {
                showAchievement(`${currentScenario.type.charAt(0).toUpperCase() + currentScenario.type.slice(1)} Master`, `You've completed all ${currentScenario.type} scenarios!`);
                setTimeout(() => {
                    backToHome();
                }, 2000);
            }
        }

        // Back to home
        function backToHome() {
            showView('home-view');
            clearInterval(timerInterval);
        }

        // Start quiz
        function startQuiz() {
            showView('quiz-view');
            currentQuizQuestion = 1;
            loadQuizQuestion();
            startQuizTimer();
        }

        // Load quiz question
        function loadQuizQuestion() {
            const question = quizQuestions[currentQuizQuestion - 1];
            document.getElementById('question-text').textContent = question.question;
            document.getElementById('current-question').textContent = currentQuizQuestion;
            document.getElementById('total-questions').textContent = quizQuestions.length;
            
            const optionsContainer = document.getElementById('quiz-options');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'option';
                optionDiv.textContent = option;
                optionDiv.addEventListener('click', () => selectQuizOption(index));
                optionsContainer.appendChild(optionDiv);
            });
            
            // Update progress bar
            const progressPercent = (currentQuizQuestion / quizQuestions.length) * 100;
            document.getElementById('quiz-progress-bar').style.width = `${progressPercent}%`;
            
            selectedOption = null;
            resetQuizUI();
        }

        // Reset quiz UI
        function resetQuizUI() {
            document.getElementById('quiz-feedback').className = 'feedback';
            document.getElementById('quiz-submit-btn').style.display = 'inline-block';
            document.getElementById('quiz-next-btn').style.display = 'none';
            document.getElementById('quiz-finish-btn').style.display = 'none';
        }

        // Select quiz option
        function selectQuizOption(index) {
            selectedOption = index;
            const options = document.querySelectorAll('#quiz-options .option');
            options.forEach((option, i) => {
                option.classList.remove('selected');
                if (i === index) {
                    option.classList.add('selected');
                }
            });
        }

        // Submit quiz answer
        function submitQuizAnswer() {
            if (selectedOption === null) {
                alert('Please select an answer first!');
                return;
            }

            clearInterval(timerInterval);
            
            const question = quizQuestions[currentQuizQuestion - 1];
            const isCorrect = selectedOption === question.correct;
            
            const options = document.querySelectorAll('#quiz-options .option');
            options.forEach((option, index) => {
                option.classList.add('disabled');
                if (index === question.correct) {
                    option.classList.add('correct');
                } else if (index === selectedOption && !isCorrect) {
                    option.classList.add('incorrect');
                }
            });

            const feedback = document.getElementById('quiz-feedback');
            if (isCorrect) {
                feedback.textContent = "Correct! Well done!";
                feedback.className = 'feedback success';
                addPoints(150);
            } else {
                feedback.textContent = `Incorrect. The correct answer was: ${question.options[question.correct]}`;
                feedback.className = 'feedback error';
                addPoints(50);
            }

            document.getElementById('quiz-submit-btn').style.display = 'none';
            if (currentQuizQuestion < quizQuestions.length) {
                document.getElementById('quiz-next-btn').style.display = 'inline-block';
            } else {
                document.getElementById('quiz-finish-btn').style.display = 'inline-block';
            }
        }

        // Next question
        function nextQuestion() {
            if (currentQuizQuestion < quizQuestions.length) {
                currentQuizQuestion++;
                loadQuizQuestion();
                startQuizTimer();
            }
        }

        // Finish quiz
        function finishQuiz() {
            if (!currentUser.badges.includes('quiz-master')) {
                currentUser.badges.push('quiz-master');
                showAchievement("Quiz Master", "You've completed your first quiz!");
                updateBadges();
            }
            
            setTimeout(() => {
                backToHome();
            }, 1500);
        }

        // Start quiz timer
        function startQuizTimer() {
            quizTimer = 30;
            document.getElementById('timer').textContent = quizTimer;
            
            timerInterval = setInterval(() => {
                quizTimer--;
                document.getElementById('timer').textContent = quizTimer;
                
                if (quizTimer <= 0) {
                    clearInterval(timerInterval);
                    if (selectedOption === null) {
                        alert('Time\'s up! Moving to next question.');
                        nextQuestion();
                    }
                }
            }, 1000);
        }

        // Add points with animation
        function addPoints(points) {
            currentUser.points += points;
            updateUserProfile();
            showPointsAnimation(points);
        }

        // Show points animation
        function showPointsAnimation(points) {
            const animation = document.createElement('div');
            animation.className = 'points-animation';
            animation.textContent = `+${points}`;
            animation.style.left = '50%';
            animation.style.top = '50%';
            document.body.appendChild(animation);
            
            setTimeout(() => {
                if (document.body.contains(animation)) {
                    document.body.removeChild(animation);
                }
            }, 2000);
        }

        // Update user profile
        function updateUserProfile() {
            // Update points display
            document.getElementById('user-points').innerHTML = `<strong>${currentUser.points.toLocaleString()}</strong> points`;
            document.getElementById('leaderboard-points').textContent = `${currentUser.points.toLocaleString()} pts`;
            
            // Update level and progress
            const newLevel = Math.floor(currentUser.points / 1000) + 1;
            const pointsInCurrentLevel = currentUser.points % 1000;
            const progressPercent = (pointsInCurrentLevel / 1000) * 100;
            
            if (newLevel > currentUser.level) {
                currentUser.level = newLevel;
                showLevelUp(newLevel);
            }
            
            currentUser.progress = progressPercent;
            
            // Update UI
            const levelElement = document.querySelector('.user-profile p:nth-child(3)');
            const progressBar = document.querySelector('.progress-bar');
            const nextLevelElement = document.getElementById('next-level');
            
            if (levelElement) {
                levelElement.innerHTML = `<strong>Level ${currentUser.level}</strong> ${getLevelTitle(currentUser.level)}`;
            }
            
            if (progressBar) {
                progressBar.style.width = `${progressPercent}%`;
            }
            
            if (nextLevelElement) {
                const pointsToNext = 1000 - pointsInCurrentLevel;
                nextLevelElement.textContent = `Next level: ${pointsToNext} points to go`;
            }
        }

        // Get level title
        function getLevelTitle(level) {
            const titles = {
                1: "Security Rookie",
                2: "Cyber Cadet",
                3: "Security Apprentice",
                4: "Cyber Guardian",
                5: "Security Expert",
                6: "Cyber Specialist",
                7: "Security Master",
                8: "Cyber Champion",
                9: "Security Legend",
                10: "Cyber Grandmaster"
            };
            return titles[level] || "Security Elite";
        }

        // Show level up
        function showLevelUp(level) {
            showAchievement(
                `Level ${level} Reached!`,
                `You are now a ${getLevelTitle(level)}!`
            );
        }

        // Check for achievements
        function checkForAchievements() {
            if (currentUser.points >= 1000 && !currentUser.badges.includes('thousand-points')) {
                currentUser.badges.push('thousand-points');
                showAchievement("Point Collector", "You've earned 1,000 points!");
                updateBadges();
            }
            
            if (currentUser.points >= 2500 && !currentUser.badges.includes('high-scorer')) {
                currentUser.badges.push('high-scorer');
                showAchievement("High Scorer", "You've earned 2,500 points!");
                updateBadges();
            }
        }

        // Update badges
        function updateBadges() {
            const badges = document.querySelectorAll('.badge');
            const badgeMap = {
                'first-login': 0,
                'phishing-expert': 1,
                'password-master': 2,
                'quiz-completed': 3,
                'social-engineering': 4,
                'malware-hunter': 5,
                'wifi-guardian': 6,
                'data-protector': 7,
                'security-champion': 8
            };
            
            currentUser.badges.forEach(badgeId => {
                const badgeIndex = badgeMap[badgeId];
                if (badgeIndex !== undefined && badges[badgeIndex]) {
                    badges[badgeIndex].classList.add('earned');
                    badges[badgeIndex].classList.remove('locked');
                }
            });
        }

        // Show achievement popup
        function showAchievement(title, description) {
            document.getElementById('achievement-title').textContent = title;
            document.getElementById('achievement-description').textContent = description;
            document.getElementById('overlay').classList.add('show');
            document.getElementById('achievement-popup').classList.add('show');
        }

        // Close achievement popup
        function closeAchievement() {
            document.getElementById('overlay').classList.remove('show');
            document.getElementById('achievement-popup').classList.remove('show');
        }

        // Initialize when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            console.log('CyberShield Academy Loading...');
            init();
            console.log('CyberShield Academy Ready!');
        });

        // Debug function to test functionality
        window.testCourse = function() {
            console.log('Testing course functionality...');
            console.log('Current user:', currentUser);
            console.log('Scenarios available:', Object.keys(scenarios));
            console.log('Quiz questions:', quizQuestions.length);
            alert('Course is working! Check console for details.');
        };
    </script>
</body>
</html>
